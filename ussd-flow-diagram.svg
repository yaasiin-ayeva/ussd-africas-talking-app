<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1884px" preserveAspectRatio="none" style="width:1231px;height:1884px;background:#FFFFFF;" version="1.1" viewBox="0 0 1231 1884" width="1231px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.2969" id="_title" style="stroke:none;stroke-width:1.0;" width="350" x="436.5" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="340" x="441.5" y="27.9951">USSD Application Flow with Africa's Talking</text><rect fill="#FFFFFF" height="1513.5078" style="stroke:#181818;stroke-width:1.0;" width="10" x="840" y="281.3906"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1148.5" y="992.5781"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="42" x2="42" y1="118.5938" y2="1803.8984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="416" x2="416" y1="118.5938" y2="1803.8984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="618" x2="618" y1="118.5938" y2="1803.8984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="844.5" x2="844.5" y1="118.5938" y2="1803.8984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1042" x2="1042" y1="118.5938" y2="1803.8984"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1153" x2="1153" y1="118.5938" y2="1803.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="23" y="115.292">User</text><ellipse cx="42" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M42,58.7969 L42,85.7969 M29,66.7969 L55,66.7969 M42,85.7969 L29,100.7969 M42,85.7969 L55,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="23" y="1815.8936">User</text><ellipse cx="42" cy="1827.6953" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M42,1835.6953 L42,1862.6953 M29,1843.6953 L55,1843.6953 M42,1862.6953 L29,1877.6953 M42,1862.6953 L55,1877.6953 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="356" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="363" y="107.292">Mobile Network</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="356" y="1802.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="363" y="1822.8936">Mobile Network</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="560" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="567.5" y="90.9951">Africa's Talking</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="567" y="107.292">USSD Gateway</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="560" y="1802.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="567.5" y="1822.8936">Africa's Talking</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="567" y="1839.1904">USSD Gateway</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="782.5" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="789.5" y="90.9951">Node.js Express</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="807.5" y="107.292">Application</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="782.5" y="1802.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="789.5" y="1822.8936">Node.js Express</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="807.5" y="1839.1904">Application</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="1006" y="115.292">Database</text><path d="M1024,66.2969 C1024,56.2969 1042,56.2969 1042,56.2969 C1042,56.2969 1060,56.2969 1060,66.2969 L1060,92.2969 C1060,102.2969 1042,102.2969 1042,102.2969 C1042,102.2969 1024,102.2969 1024,92.2969 L1024,66.2969 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1024,66.2969 C1024,76.2969 1042,76.2969 1042,76.2969 C1042,76.2969 1060,76.2969 1060,66.2969 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="1006" y="1815.8936">Database</text><path d="M1024,1829.1953 C1024,1819.1953 1042,1819.1953 1042,1819.1953 C1042,1819.1953 1060,1819.1953 1060,1829.1953 L1060,1855.1953 C1060,1865.1953 1042,1865.1953 1042,1865.1953 C1042,1865.1953 1024,1865.1953 1024,1855.1953 L1024,1829.1953 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1024,1829.1953 C1024,1839.1953 1042,1839.1953 1042,1839.1953 C1042,1839.1953 1060,1839.1953 1060,1829.1953 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="1088" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="1095" y="90.9951">External Services</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="1101.5" y="107.292">(Payment, etc.)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="1088" y="1802.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="1095" y="1822.8936">External Services</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="1101.5" y="1839.1904">(Payment, etc.)</text><rect fill="#FFFFFF" height="1513.5078" style="stroke:#181818;stroke-width:1.0;" width="10" x="840" y="281.3906"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1148.5" y="992.5781"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1224" x="0" y="149.1602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1224" y1="149.1602" y2="149.1602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1224" y1="152.1602" y2="152.1602"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="169" x="527.5" y="138.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150" x="533.5" y="154.6606">Session Initialization</text><polygon fill="#181818" points="404,188.8594,414,192.8594,404,196.8594,408,192.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42" x2="410" y1="192.8594" y2="192.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="49" y="187.7935">Dial USSD code (*123#)</text><polygon fill="#181818" points="606,217.9922,616,221.9922,606,225.9922,610,221.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="416" x2="612" y1="221.9922" y2="221.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="423" y="216.9263">Forward USSD request</text><polygon fill="#181818" points="828,277.3906,838,281.3906,828,285.3906,832,281.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="618" x2="834" y1="281.3906" y2="281.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="625" y="246.0591">POST /ussd/callback</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="625" y="261.1919">(sessionId, serviceCode,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="625" y="276.3247">phoneNumber, text="")</text><line style="stroke:#181818;stroke-width:1.0;" x1="850" x2="892" y1="310.5234" y2="310.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="892" x2="892" y1="310.5234" y2="323.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="851" x2="892" y1="323.5234" y2="323.5234"/><polygon fill="#181818" points="861,319.5234,851,323.5234,861,327.5234,857,323.5234" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="857" y="305.4575">Process initial request</text><polygon fill="#181818" points="629,348.6563,619,352.6563,629,356.6563,625,352.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="623" x2="839" y1="352.6563" y2="352.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="635" y="347.5903">CON Welcome Menu Response</text><polygon fill="#181818" points="427,377.7891,417,381.7891,427,385.7891,423,381.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="421" x2="617" y1="381.7891" y2="381.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="433" y="376.7231">Menu display</text><polygon fill="#181818" points="53,406.9219,43,410.9219,53,414.9219,49,410.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="47" x2="415" y1="410.9219" y2="410.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="59" y="405.856">Show USSD Menu</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1224" x="0" y="439.4883"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1224" y1="439.4883" y2="439.4883"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1224" y1="442.4883" y2="442.4883"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="143" x="540.5" y="428.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="124" x="546.5" y="444.9888">Menu Navigation</text><polygon fill="#181818" points="404,479.1875,414,483.1875,404,487.1875,408,483.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42" x2="410" y1="483.1875" y2="483.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="49" y="478.1216">Select menu option (e.g. "1")</text><polygon fill="#181818" points="606,508.3203,616,512.3203,606,516.3203,610,512.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="416" x2="612" y1="512.3203" y2="512.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="423" y="507.2544">Forward selection</text><polygon fill="#181818" points="828,567.7188,838,571.7188,828,575.7188,832,571.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="618" x2="834" y1="571.7188" y2="571.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="625" y="536.3872">POST /ussd/callback</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="625" y="551.52">(sessionId, serviceCode,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="625" y="566.6528">phoneNumber, text="1")</text><polygon fill="#181818" points="1030,596.8516,1040,600.8516,1030,604.8516,1034,600.8516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="850" x2="1036" y1="600.8516" y2="600.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="857" y="595.7856">Query user data</text><polygon fill="#181818" points="861,625.9844,851,629.9844,861,633.9844,857,629.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="855" x2="1041" y1="629.9844" y2="629.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="867" y="624.9185">Return data</text><polygon fill="#181818" points="629,655.1172,619,659.1172,629,663.1172,625,659.1172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="623" x2="839" y1="659.1172" y2="659.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="635" y="654.0513">CON Sub-menu Response</text><polygon fill="#181818" points="427,684.25,417,688.25,427,692.25,423,688.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="421" x2="617" y1="688.25" y2="688.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="433" y="683.1841">Sub-menu display</text><polygon fill="#181818" points="53,713.3828,43,717.3828,53,721.3828,49,717.3828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="47" x2="415" y1="717.3828" y2="717.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="59" y="712.3169">Show sub-menu</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1224" x="0" y="745.9492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1224" y1="745.9492" y2="745.9492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1224" y1="748.9492" y2="748.9492"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="190" x="517" y="735.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="171" x="523" y="751.4497">Transaction Processing</text><polygon fill="#181818" points="404,785.6484,414,789.6484,404,793.6484,408,789.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42" x2="410" y1="789.6484" y2="789.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="350" x="49" y="784.5825">Enter transaction details (e.g. "2*254712345678*100")</text><polygon fill="#181818" points="606,814.7813,616,818.7813,606,822.7813,610,818.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="416" x2="612" y1="818.7813" y2="818.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="423" y="813.7153">Forward input</text><polygon fill="#181818" points="828,859.0469,838,863.0469,828,867.0469,832,863.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="618" x2="834" y1="863.0469" y2="863.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="625" y="842.8481">POST /ussd/callback</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="625" y="857.981">(text="2*254712345678*100")</text><line style="stroke:#181818;stroke-width:1.0;" x1="850" x2="892" y1="892.1797" y2="892.1797"/><line style="stroke:#181818;stroke-width:1.0;" x1="892" x2="892" y1="892.1797" y2="905.1797"/><line style="stroke:#181818;stroke-width:1.0;" x1="851" x2="892" y1="905.1797" y2="905.1797"/><polygon fill="#181818" points="861,901.1797,851,905.1797,861,909.1797,857,905.1797" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="857" y="887.1138">Validate input</text><polygon fill="#181818" points="1030,930.3125,1040,934.3125,1030,938.3125,1034,934.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="850" x2="1036" y1="934.3125" y2="934.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="857" y="929.2466">Check balance</text><polygon fill="#181818" points="861,959.4453,851,963.4453,861,967.4453,857,963.4453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="855" x2="1041" y1="963.4453" y2="963.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="867" y="958.3794">Balance info</text><polygon fill="#181818" points="1136.5,988.5781,1146.5,992.5781,1136.5,996.5781,1140.5,992.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="850" x2="1142.5" y1="992.5781" y2="992.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="857" y="987.5122">Process payment</text><polygon fill="#181818" points="861,1017.7109,851,1021.7109,861,1025.7109,857,1021.7109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="855" x2="1152.5" y1="1021.7109" y2="1021.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="867" y="1016.645">Payment response</text><polygon fill="#181818" points="1030,1046.8438,1040,1050.8438,1030,1054.8438,1034,1050.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="850" x2="1036" y1="1050.8438" y2="1050.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="857" y="1045.7778">Update transaction record</text><polygon fill="#181818" points="629,1075.9766,619,1079.9766,629,1083.9766,625,1079.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="623" x2="839" y1="1079.9766" y2="1079.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="635" y="1074.9106">END Transaction confirmation</text><polygon fill="#181818" points="427,1105.1094,417,1109.1094,427,1113.1094,423,1109.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="421" x2="617" y1="1109.1094" y2="1109.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="433" y="1104.0435">Final message</text><polygon fill="#181818" points="53,1134.2422,43,1138.2422,53,1142.2422,49,1138.2422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="47" x2="415" y1="1138.2422" y2="1138.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="59" y="1133.1763">Show confirmation message</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1224" x="0" y="1166.8086"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1224" y1="1166.8086" y2="1166.8086"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1224" y1="1169.8086" y2="1169.8086"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="126" x="549" y="1156.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="107" x="555" y="1172.3091">Error Handling</text><polygon fill="#181818" points="404,1206.5078,414,1210.5078,404,1214.5078,408,1210.5078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42" x2="410" y1="1210.5078" y2="1210.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="49" y="1205.4419">Invalid input</text><polygon fill="#181818" points="606,1235.6406,616,1239.6406,606,1243.6406,610,1239.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="416" x2="612" y1="1239.6406" y2="1239.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="423" y="1234.5747">Forward input</text><polygon fill="#181818" points="828,1279.9063,838,1283.9063,828,1287.9063,832,1283.9063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="618" x2="834" y1="1283.9063" y2="1283.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="625" y="1263.7075">POST /ussd/callback</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="625" y="1278.8403">(invalid text)</text><line style="stroke:#181818;stroke-width:1.0;" x1="850" x2="892" y1="1313.0391" y2="1313.0391"/><line style="stroke:#181818;stroke-width:1.0;" x1="892" x2="892" y1="1313.0391" y2="1326.0391"/><line style="stroke:#181818;stroke-width:1.0;" x1="851" x2="892" y1="1326.0391" y2="1326.0391"/><polygon fill="#181818" points="861,1322.0391,851,1326.0391,861,1330.0391,857,1326.0391" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="857" y="1307.9731">Validate input fails</text><polygon fill="#181818" points="629,1351.1719,619,1355.1719,629,1359.1719,625,1355.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="623" x2="839" y1="1355.1719" y2="1355.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="635" y="1350.106">END Error message</text><polygon fill="#181818" points="427,1380.3047,417,1384.3047,427,1388.3047,423,1384.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="421" x2="617" y1="1384.3047" y2="1384.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="433" y="1379.2388">Error display</text><polygon fill="#181818" points="53,1409.4375,43,1413.4375,53,1417.4375,49,1413.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="47" x2="415" y1="1413.4375" y2="1413.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="59" y="1408.3716">Show error message</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1224" x="0" y="1442.0039"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1224" y1="1442.0039" y2="1442.0039"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1224" y1="1445.0039" y2="1445.0039"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="139" x="542.5" y="1431.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120" x="548.5" y="1447.5044">Session Timeout</text><path d="M5,1469.5703 L5,1494.5703 L453,1494.5703 L453,1479.5703 L443,1469.5703 L5,1469.5703 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M443,1469.5703 L443,1479.5703 L453,1479.5703 L443,1469.5703 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284" x="82.5" y="1486.6372">User does not respond within timeout period</text><polygon fill="#181818" points="606,1516.8359,616,1520.8359,606,1524.8359,610,1520.8359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="416" x2="612" y1="1520.8359" y2="1520.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="423" y="1515.77">Session timeout notification</text><polygon fill="#181818" points="828,1545.9688,838,1549.9688,828,1553.9688,832,1549.9688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="618" x2="834" y1="1549.9688" y2="1549.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="625" y="1544.9028">Session timeout webhook</text><polygon fill="#181818" points="1030,1575.1016,1040,1579.1016,1030,1583.1016,1034,1579.1016" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="850" x2="1036" y1="1579.1016" y2="1579.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="857" y="1574.0356">Update session status</text><line style="stroke:#181818;stroke-width:1.0;" x1="850" x2="892" y1="1608.2344" y2="1608.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="892" x2="892" y1="1608.2344" y2="1621.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="851" x2="892" y1="1621.2344" y2="1621.2344"/><polygon fill="#181818" points="861,1617.2344,851,1621.2344,861,1625.2344,857,1621.2344" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="857" y="1603.1685">Cleanup resources</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1224" x="0" y="1649.8008"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1224" y1="1649.8008" y2="1649.8008"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1224" y1="1652.8008" y2="1652.8008"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="166" x="529" y="1639.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="147" x="535" y="1655.3013">Analytics &amp; Logging</text><line style="stroke:#181818;stroke-width:1.0;" x1="850" x2="892" y1="1693.5" y2="1693.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="892" x2="892" y1="1693.5" y2="1706.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="851" x2="892" y1="1706.5" y2="1706.5"/><polygon fill="#181818" points="861,1702.5,851,1706.5,861,1710.5,857,1706.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="857" y="1688.4341">Log session activity</text><polygon fill="#0000FF" points="629,1731.6328,619,1735.6328,629,1739.6328,625,1735.6328" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="623" x2="839" y1="1735.6328" y2="1735.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="635" y="1730.5669">Usage analytics</text><path d="M855,1748.6328 L855,1788.6328 L1052,1788.6328 L1052,1758.6328 L1042,1748.6328 L855,1748.6328 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1042,1748.6328 L1042,1758.6328 L1052,1758.6328 L1042,1748.6328 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="861" y="1765.6997">All interactions are logged</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="861" y="1780.8325">for analytics and debugging</text><!--MD5=[3a777dc1300cfc523a0173e857891961]
@startuml
actor "User" as user
participant "Mobile Network" as network
participant "Africa's Talking\nUSSD Gateway" as gateway
participant "Node.js Express\nApplication" as app
database "Database" as db
participant "External Services\n(Payment, etc.)" as ext

title USSD Application Flow with Africa's Talking

== Session Initialization ==

user -> network : Dial USSD code (*123#)
network -> gateway : Forward USSD request
gateway -> app : POST /ussd/callback\n(sessionId, serviceCode,\nphoneNumber, text="")
activate app
app -> app : Process initial request
app - -> gateway : CON Welcome Menu Response
gateway - -> network : Menu display
network - -> user : Show USSD Menu

== Menu Navigation ==

user -> network : Select menu option (e.g. "1")
network -> gateway : Forward selection
gateway -> app : POST /ussd/callback\n(sessionId, serviceCode,\nphoneNumber, text="1")
app -> db : Query user data
db - -> app : Return data
app - -> gateway : CON Sub-menu Response
gateway - -> network : Sub-menu display
network - -> user : Show sub-menu

== Transaction Processing ==

user -> network : Enter transaction details (e.g. "2*254712345678*100")
network -> gateway : Forward input
gateway -> app : POST /ussd/callback\n(text="2*254712345678*100")
app -> app : Validate input
app -> db : Check balance
db - -> app : Balance info
app -> ext : Process payment
activate ext
ext - -> app : Payment response
deactivate ext
app -> db : Update transaction record
app - -> gateway : END Transaction confirmation
gateway - -> network : Final message
network - -> user : Show confirmation message

== Error Handling ==

user -> network : Invalid input
network -> gateway : Forward input
gateway -> app : POST /ussd/callback\n(invalid text)
app -> app : Validate input fails
app - -> gateway : END Error message
gateway - -> network : Error display
network - -> user : Show error message

== Session Timeout ==

note over user, network
  User does not respond within timeout period
end note
network -> gateway : Session timeout notification
gateway -> app : Session timeout webhook
app -> db : Update session status
app -> app : Cleanup resources

== Analytics & Logging ==

app -> app : Log session activity
app -[#blue]> gateway : Usage analytics
note right of app
  All interactions are logged
  for analytics and debugging
end note
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>